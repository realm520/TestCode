/*
 * test_array.cpp
 *
 *  Created on: 2014年4月12日
 *      Author: bill
 */
#include <cstring>
#include <iostream>

#define KEY_BUF_LEN          128

struct RSAPriKey{
    char m_sKeyVersion[16];           //ÃÜÔ¿°æ±¾ºÅ
    char m_sKeyN[KEY_BUF_LEN*2 + 1];  //RSA_N
    char m_sKeyE[KEY_BUF_LEN + 1];    //¹«Ô¿(·ÇRSAÀàÊ±,´æ·ÅÃÜÂë¶Î)
    char m_sKeyD[KEY_BUF_LEN*2 + 1];  //Ë½Ô¿
    char m_sKeyP[KEY_BUF_LEN + 1];    //ËØÊýP
    char m_sKeyQ[KEY_BUF_LEN + 1];    //ËØÊýQ
    char m_sKeyDP[KEY_BUF_LEN + 1];   //D % (P - 1)
    char m_sKeyDQ[KEY_BUF_LEN + 1];   //D % (Q - 1)
    char m_sKeyQP[KEY_BUF_LEN + 1];   //1 // (Q % P)
    char m_sEffDate[16];              //ÉúÐ§ÈÕÆÚ
    char m_sExpDate[16];              //Ê§Ð§ÈÕÆÚ
    char m_sKeyState[4];              //ÃÜÔ¿×´Ì¬
    void print() {
        std::cout << "Private key: " << std::endl;
        std::cout << "\tkeyN:     " << m_sKeyN << std::endl;
        std::cout << "\tkeyE:     " << m_sKeyE << std::endl;
        std::cout << "\tkeyD:     " << m_sKeyD << std::endl;
        std::cout << "\tkeyP:     " << m_sKeyP << std::endl;
        std::cout << "\tkeyQ:     " << m_sKeyQ << std::endl;
        std::cout << "\tkeyDP:    " << m_sKeyDP << std::endl;
        std::cout << "\tkeyDQ:    " << m_sKeyDQ << std::endl;
        std::cout << "\tkeyQP:    " << m_sKeyQP << std::endl;
        std::cout << "\tversion:  " << m_sKeyVersion << std::endl;
        std::cout << "\tEffDate:  " << m_sEffDate << std::endl;
        std::cout << "\tExpDate:  " << m_sExpDate << std::endl;
        std::cout << "\tKeyState: " << m_sKeyState << std::endl;
    }
};

void printKey(RSAPriKey key) {
    std::cout << "sizeof key: " << sizeof key << std::endl;
    key.print();
}

int main() {
    RSAPriKey key;
    memset(&key, 0, sizeof(RSAPriKey));
    memcpy(key.m_sKeyVersion, "20140410120334", strlen("20140410120334"));
    memcpy(key.m_sKeyN, "8EC808AD395E438FEF4A8C2A29DD37902E0ACB55C9A9D761EC2A3BDF7C8B090BE7BB1D1A67774778CBEFE6937F79AE62C38488EF405D1D1D9588C61821E129F07AB1A48A22AB115CA51750F64DF165B1DEB04A6553ED35187B303ECE7D5D96636E7D46E971D564F7605D873C548024098B2D1A3806BBADD4053FD70D2FEF519D", strlen("8EC808AD395E438FEF4A8C2A29DD37902E0ACB55C9A9D761EC2A3BDF7C8B090BE7BB1D1A67774778CBEFE6937F79AE62C38488EF405D1D1D9588C61821E129F07AB1A48A22AB115CA51750F64DF165B1DEB04A6553ED35187B303ECE7D5D96636E7D46E971D564F7605D873C548024098B2D1A3806BBADD4053FD70D2FEF519D"));
    memcpy(key.m_sKeyE, "AAE06E5F", strlen("AAE06E5F"));
    memcpy(key.m_sKeyD, "76E9205FEEA3CB2BCB9EE5E01810080E66E4F90A0048FABE32FDA008304ECFD68A719B8DAF9EEEEE989EEF434C963184149AC2E0AB5AC098C458EA8CA4249AB2A4BA0352852604204A18C72F07527E1393AE9F51D7EFCD4747D6A3064322E22CF039954E83A3AFA1F06D39D21986C1A360C5C4070E5E67383280F0470954E69F", strlen("76E9205FEEA3CB2BCB9EE5E01810080E66E4F90A0048FABE32FDA008304ECFD68A719B8DAF9EEEEE989EEF434C963184149AC2E0AB5AC098C458EA8CA4249AB2A4BA0352852604204A18C72F07527E1393AE9F51D7EFCD4747D6A3064322E22CF039954E83A3AFA1F06D39D21986C1A360C5C4070E5E67383280F0470954E69F"));
    memcpy(key.m_sKeyP, "F4B2C2FC7A547944ACBB0E0931A3D69590DF55A740AD5E6D61D2D2C228BEE0E2B6F4FDD30591245787D1075E0FCB70FBA69F62751A7E044840C4363316A79DE1", strlen("F4B2C2FC7A547944ACBB0E0931A3D69590DF55A740AD5E6D61D2D2C228BEE0E2B6F4FDD30591245787D1075E0FCB70FBA69F62751A7E044840C4363316A79DE1"));
    memcpy(key.m_sKeyQ, "95603CD6BCAF861A50E4048A1682A5FE8A0E85E769CDADA607449EAE7AD54D3FE41BEAAB29C5B3BD1CD14037F137096504D334B76CB2F244CF37941ACC27133D", strlen("95603CD6BCAF861A50E4048A1682A5FE8A0E85E769CDADA607449EAE7AD54D3FE41BEAAB29C5B3BD1CD14037F137096504D334B76CB2F244CF37941ACC27133D"));
    memcpy(key.m_sKeyDP, "60905E68E4E706D745289BD4BAB0DC7B20D06B65DF1E50A92128B9A7ECAE75A7157AA1E801CBA052DEF65FAAFC21785A924DA0828D886B331FA91D6E55CF5F3F", strlen("60905E68E4E706D745289BD4BAB0DC7B20D06B65DF1E50A92128B9A7ECAE75A7157AA1E801CBA052DEF65FAAFC21785A924DA0828D886B331FA91D6E55CF5F3F"));
    memcpy(key.m_sKeyDQ, "65D4D796181866C849659DF3519D99A1E17D09006F5743DDD976426DD16E092BB4D40538054AC4A80AF0F5EE51D659200F80818671E79191E51A88F683882F83", strlen("65D4D796181866C849659DF3519D99A1E17D09006F5743DDD976426DD16E092BB4D40538054AC4A80AF0F5EE51D659200F80818671E79191E51A88F683882F83"));
    memcpy(key.m_sKeyQP, "0F997E70E06BF8F881C9308A30C7E5E2C8D14EE131D4E89CB79FF03F341B7FDC19FA6E0C69C385C6D27B443B8A22936E1F73E0D850FDEA625A27B8FC3F3FF307", strlen("0F997E70E06BF8F881C9308A30C7E5E2C8D14EE131D4E89CB79FF03F341B7FDC19FA6E0C69C385C6D27B443B8A22936E1F73E0D850FDEA625A27B8FC3F3FF307"));
    memcpy(key.m_sEffDate, "20140410120334", strlen("20140410120334"));
    memcpy(key.m_sExpDate, "20140423155014", strlen("20140423155014"));
    memcpy(key.m_sKeyState, "K0A", strlen("K0A"));

    printKey(key);
    return 0;
}
